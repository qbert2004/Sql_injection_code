# SQL Injection Protector AI Agent

**ĞŸĞ¾Ğ»Ğ½Ğ¾Ñ†ĞµĞ½Ğ½Ñ‹Ğ¹ AI Ğ°Ğ³ĞµĞ½Ñ‚ Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ¾Ñ‚Ğ²Ñ€Ğ°Ñ‰ĞµĞ½Ğ¸Ñ SQL Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹**

ĞœĞ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ·Ğ°Ñ‰Ğ¸Ñ‚Ñ‹, Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒÑÑ‰Ğ°Ñ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·, Ğ¼Ğ°ÑˆĞ¸Ğ½Ğ½Ğ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸ ÑĞ²Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· Ğ´Ğ»Ñ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ SQL Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹ Ğ² Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾Ğ¼ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸.

---

## ğŸš€ Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

- âœ… **ĞœĞ½Ğ¾Ğ³Ğ¾ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ²Ğ¾Ğµ Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ**
  - Ğ¡Ğ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (regex Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹)
  - Machine Learning (TF-IDF + Logistic Regression)
  - Ğ­Ğ²Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·

- âœ… **REST API** (FastAPI)
  - Endpoint Ğ´Ğ»Ñ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ° Ñ‚ĞµĞºÑÑ‚Ğ°
  - ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· API
  - ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³

- âœ… **FastAPI Middleware**
  - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ²ÑĞµÑ… Ğ²Ñ…Ğ¾Ğ´ÑÑ‰Ğ¸Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
  - ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° query Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¾Ğ², body, headers
  - Whitelist Ğ¿ÑƒÑ‚ĞµĞ¹

- âœ… **CLI Interface**
  - ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°
  - ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
  - Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
  - Ğ‘ĞµĞ½Ñ‡Ğ¼Ğ°Ñ€ĞºĞ¸

- âœ… **Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ Database Layer**
  - ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ğ¸Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹
  - ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° SQLAlchemy, asyncpg, psycopg2
  - Query Builder

- âœ… **Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³**
  - Structured logging (structlog)
  - SIEM-ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚
  - ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸

---

## ğŸ“¦ Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

### 1. ĞšĞ»Ğ¾Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ñ

```bash
git clone <repository-url>
cd SQL_INJECTION_PROTECTOR_AI_AGENT
```

### 2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ²Ğ¸Ñ€Ñ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ğ¾ĞºÑ€ÑƒĞ¶ĞµĞ½Ğ¸Ñ

```bash
python -m venv .venv
```

**Windows:**
```bash
.venv\Scripts\activate
```

**Linux/Mac:**
```bash
source .venv/bin/activate
```

### 3. Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ĞµĞ¹

```bash
pip install -r requirements.txt
```

---

## ğŸ¯ Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: CLI

```bash
# ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸
python cli.py train

# ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°
python cli.py analyze "' OR '1'='1"

# Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
python cli.py test

# Ğ‘ĞµĞ½Ñ‡Ğ¼Ğ°Ñ€Ğº
python cli.py benchmark
```

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: API ÑĞµÑ€Ğ²ĞµÑ€

```bash
# Ğ—Ğ°Ğ¿ÑƒÑĞº ÑĞµÑ€Ğ²ĞµÑ€Ğ°
python app.py

# Ğ˜Ğ»Ğ¸ Ñ‡ĞµÑ€ĞµĞ· CLI
python cli.py server
```

Ğ¡ĞµÑ€Ğ²ĞµÑ€ Ğ±ÑƒĞ´ĞµÑ‚ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ĞµĞ½ Ğ¿Ğ¾ Ğ°Ğ´Ñ€ĞµÑÑƒ: http://localhost:8000

ğŸ“Š **Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ API:** http://localhost:8000/docs

### Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 3: Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚ Ğ² ĞºĞ¾Ğ´

```python
from sql_injection_detector import SQLInjectionAgent

# Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
agent = SQLInjectionAgent(ml_model_path="sql_injection_model.pkl")

# ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°
result = agent.analyze("' OR '1'='1")

print(f"Ğ’Ñ€ĞµĞ´Ğ¾Ğ½Ğ¾ÑĞ½Ñ‹Ğ¹: {result.is_malicious}")
print(f"Ğ£Ğ²ĞµÑ€ĞµĞ½Ğ½Ğ¾ÑÑ‚ÑŒ: {result.confidence:.2%}")
print(f"ĞœĞµÑ‚Ğ¾Ğ´: {result.detection_method}")
```

---

## ğŸ“– Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

### CLI ĞšĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹

#### `analyze` - ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°

```bash
# Ğ›Ğ¾ĞºĞ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·
python cli.py analyze "text to analyze"

# ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‡ĞµÑ€ĞµĞ· API
python cli.py analyze "text to analyze" --api
```

#### `train` - ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸

```bash
# ĞŸÑ€Ğ¾Ğ´Ğ²Ğ¸Ğ½ÑƒÑ‚Ğ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ (Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ)
python cli.py train

# Ğ‘Ñ‹ÑÑ‚Ñ€Ğ¾Ğµ Ğ¾Ğ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ
python cli.py train --simple
```

#### `test` - Ğ˜Ğ½Ñ‚ĞµÑ€Ğ°ĞºÑ‚Ğ¸Ğ²Ğ½Ğ¾Ğµ Ñ‚ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

```bash
python cli.py test
```

#### `benchmark` - Ğ—Ğ°Ğ¿ÑƒÑĞº Ğ±ĞµĞ½Ñ‡Ğ¼Ğ°Ñ€ĞºĞ°

```bash
python cli.py benchmark
```

#### `server` - Ğ—Ğ°Ğ¿ÑƒÑĞº API ÑĞµÑ€Ğ²ĞµÑ€Ğ°

```bash
python cli.py server --host 0.0.0.0 --port 8000
```

#### `status` - Ğ¡Ñ‚Ğ°Ñ‚ÑƒÑ ÑĞµÑ€Ğ²ĞµÑ€Ğ°

```bash
python cli.py status --api-url http://localhost:8000
```

#### `export-dataset` - Ğ­ĞºÑĞ¿Ğ¾Ñ€Ñ‚ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğ°

```bash
python cli.py export-dataset -o dataset.json --augment
```

---

### API Endpoints

#### `POST /api/analyze` - ĞĞ½Ğ°Ğ»Ğ¸Ğ· Ñ‚ĞµĞºÑÑ‚Ğ°

**Request:**
```json
{
  "text": "' OR '1'='1",
  "source": "user_input"
}
```

**Response:**
```json
{
  "is_malicious": true,
  "confidence": 0.95,
  "detection_method": "signature",
  "matched_patterns": ["or_injection", "quote_escape"],
  "risk_score": 0.98,
  "timestamp": "2024-01-15T10:30:00Z"
}
```

#### `GET /health` - Health Check

```json
{
  "status": "healthy",
  "timestamp": "2024-01-15T10:30:00Z",
  "agent_status": "active"
}
```

#### `GET /metrics` - ĞœĞµÑ‚Ñ€Ğ¸ĞºĞ¸

```json
{
  "total_requests": 1000,
  "blocked_requests": 50,
  "suspicious_requests": 10,
  "block_rate": 0.05,
  "uptime_seconds": 3600
}
```

#### `POST /api/train` - ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ´ĞµĞ»Ğ¸

**Request:**
```json
{
  "malicious_samples": ["' OR '1'='1", "admin' --"],
  "safe_samples": ["john@example.com", "Product123"]
}
```

---

### Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ğ² FastAPI Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ

```python
from fastapi import FastAPI
from sql_injection_detector import SQLInjectionAgent
from fastapi_middleware import SQLInjectionMiddleware

app = FastAPI()

# Ğ˜Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ°Ğ³ĞµĞ½Ñ‚Ğ°
agent = SQLInjectionAgent(ml_model_path="sql_injection_model.pkl")

# Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ middleware
app.add_middleware(
    SQLInjectionMiddleware,
    agent=agent,
    enabled=True,
    block_on_detection=True,
    whitelist_paths=['/health', '/docs', '/openapi.json']
)

@app.get("/users/{user_id}")
async def get_user(user_id: str):
    # ĞŸĞ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞµĞ½Ñ‹ middleware
    return {"user_id": user_id}
```

---

### Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ Database Layer

```python
from safe_database_layer import SafeQueryBuilder, SafeAsyncPostgresRepository

# Query Builder
query, params = SafeQueryBuilder.select(
    table="users",
    columns=["id", "username"],
    conditions={"status": "active"},
    limit=10
)
# query: "SELECT id, username FROM users WHERE status = :param_0 LIMIT :limit"
# params: {"param_0": "active", "limit": 10}

# Async PostgreSQL
repo = SafeAsyncPostgresRepository("postgresql://user:pass@localhost/db")
await repo.initialize()

users = await repo.execute_safe_query(
    "SELECT * FROM users WHERE email = $1",
    "user@example.com"
)
```

---

## ğŸ§ª Ğ¢ĞµÑÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

### Ğ—Ğ°Ğ¿ÑƒÑĞº Ñ‚ĞµÑÑ‚Ğ¾Ğ²

```bash
# Ğ’ÑĞµ Ñ‚ĞµÑÑ‚Ñ‹
pytest tests/ -v

# Ğ¡ Ğ¿Ğ¾ĞºÑ€Ñ‹Ñ‚Ğ¸ĞµĞ¼
pytest tests/ --cov=. --cov-report=html

# ĞšĞ¾Ğ½ĞºÑ€ĞµÑ‚Ğ½Ñ‹Ğ¹ Ñ‚ĞµÑÑ‚
pytest tests/test_agent.py::TestSQLInjectionAgent::test_detect_classic_injection -v
```

---

## ğŸ“Š ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FastAPI Application                   â”‚
â”‚                     (app.py)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚ SQL Injection       â”‚
            â”‚ Middleware          â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  SQL Injection Agent         â”‚
        â”‚  (sql_injection_detector.py) â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ Signature   â”‚ â”‚ ML        â”‚ â”‚ Heuristic   â”‚
â”‚ Policy      â”‚ â”‚ Detector  â”‚ â”‚ Analyzer    â”‚
â”‚ (Regex)     â”‚ â”‚ (TF-IDF)  â”‚ â”‚ (Stats)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”’ ĞœĞµÑ‚Ğ¾Ğ´Ñ‹ Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### 1. Ğ¡Ğ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ½Ñ‹Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (Signature Policy)

Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ Ñ€ĞµĞ³ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğµ Ğ²Ñ‹Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñ Ğ´Ğ»Ñ Ğ¿Ğ¾Ğ¸ÑĞºĞ° Ğ¸Ğ·Ğ²ĞµÑÑ‚Ğ½Ñ‹Ñ… Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ğ¾Ğ² SQL Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¹:

- `UNION SELECT` Ğ°Ñ‚Ğ°ĞºĞ¸
- SQL ĞºĞ¾Ğ¼Ğ¼ĞµĞ½Ñ‚Ğ°Ñ€Ğ¸Ğ¸ (`--`, `#`, `/* */`)
- `DROP TABLE`, `DELETE`, `UPDATE` ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
- `xp_cmdshell` Ğ¸ Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ ĞºĞ¾Ğ¼Ğ°Ğ½Ğ´Ñ‹
- Encoded Ğ¸Ğ½ÑŠĞµĞºÑ†Ğ¸Ğ¸ (hex, URL encoding)

### 2. Machine Learning (ML Detector)

- **ĞĞ»Ğ³Ğ¾Ñ€Ğ¸Ñ‚Ğ¼:** TF-IDF Vectorization + Logistic Regression
- **Features:** Character-level n-grams (2-5 ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²)
- **ĞĞ±ÑƒÑ‡ĞµĞ½Ğ¸Ğµ:** ĞĞ° Ñ€Ğ°Ğ·Ğ¼ĞµÑ‡ĞµĞ½Ğ½Ğ¾Ğ¼ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğµ Ğ²Ñ€ĞµĞ´Ğ¾Ğ½Ğ¾ÑĞ½Ñ‹Ñ… Ğ¸ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²

### 3. Ğ­Ğ²Ñ€Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ· (Heuristic Analyzer)

ĞĞ½Ğ°Ğ»Ğ¸Ğ·Ğ¸Ñ€ÑƒĞµÑ‚ ÑÑ‚Ğ°Ñ‚Ğ¸ÑÑ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğµ Ñ…Ğ°Ñ€Ğ°ĞºÑ‚ĞµÑ€Ğ¸ÑÑ‚Ğ¸ĞºĞ¸:

- Ğ”Ğ»Ğ¸Ğ½Ğ° ÑÑ‚Ñ€Ğ¾ĞºĞ¸
- ĞŸÑ€Ğ¾Ñ†ĞµĞ½Ñ‚ ÑĞ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ñ‹Ñ… ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ğ¾Ğ²
- ĞšĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ SQL ĞºĞ»ÑÑ‡ĞµĞ²Ñ‹Ñ… ÑĞ»Ğ¾Ğ²
- Ğ­Ğ½Ñ‚Ñ€Ğ¾Ğ¿Ğ¸Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ¸
- Encoded ÑĞ¸Ğ¼Ğ²Ğ¾Ğ»Ñ‹

---

## ğŸ“ˆ ĞŸÑ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

**Ğ¡Ñ€ĞµĞ´Ğ½ÑÑ ÑĞºĞ¾Ñ€Ğ¾ÑÑ‚ÑŒ Ğ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°:** < 10ms Ğ½Ğ° Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ

**Ğ¢Ğ¾Ñ‡Ğ½Ğ¾ÑÑ‚ÑŒ (Ğ½Ğ° Ñ‚ĞµÑÑ‚Ğ¾Ğ²Ğ¾Ğ¼ Ğ´Ğ°Ñ‚Ğ°ÑĞµÑ‚Ğµ):**
- Accuracy: ~95%
- Precision: ~92%
- Recall: ~96%
- F1-Score: ~94%

---

## ğŸ›¡ï¸ ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ²Ğ°ĞµĞ¼Ñ‹Ñ… Ğ°Ñ‚Ğ°Ğº

| Ğ¢Ğ¸Ğ¿ Ğ°Ñ‚Ğ°ĞºĞ¸ | ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ | ĞĞ±Ğ½Ğ°Ñ€ÑƒĞ¶ĞµĞ½Ğ¾ |
|-----------|--------|------------|
| Classic | `' OR '1'='1` | âœ… |
| UNION-based | `' UNION SELECT * FROM users--` | âœ… |
| Comment-based | `admin' --` | âœ… |
| Time-based blind | `' AND SLEEP(5)--` | âœ… |
| Boolean-based blind | `' AND 1=1--` | âœ… |
| Stacked queries | `'; DROP TABLE users--` | âœ… |
| Encoded | `%27%20OR%201=1--` | âœ… |

---

## ğŸ”§ ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ

### ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° Ğ¿Ğ¾Ñ€Ğ¾Ğ³Ğ¾Ğ² Ğ´ĞµÑ‚ĞµĞºÑ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

```python
agent = SQLInjectionAgent(ml_model_path="sql_injection_model.pkl")

# Ğ˜Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾Ñ€Ğ¾Ğ³Ğ¾Ğ²
agent.DETECTION_THRESHOLD = 0.6  # Default: 0.5
agent.RISK_THRESHOLD = 0.7       # Default: 0.6
```

### ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° middleware

```python
app.add_middleware(
    SQLInjectionMiddleware,
    agent=agent,
    enabled=True,                # Ğ’ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ/Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ¸Ñ‚ÑŒ
    block_on_detection=True,      # Ğ‘Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ
    check_query_params=True,      # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ query Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
    check_body=True,              # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ body
    check_headers=True,           # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ headers
    whitelist_paths=['/health'],  # Whitelist Ğ¿ÑƒÑ‚ĞµĞ¹
    alert_webhook="https://...",  # Webhook Ğ´Ğ»Ñ Ğ°Ğ»ĞµÑ€Ñ‚Ğ¾Ğ²
    max_request_size=1024*1024    # ĞœĞ°ĞºÑĞ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ñ€Ğ°Ğ·Ğ¼ĞµÑ€ body
)
```

---

## ğŸ“ Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ

Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞµÑ‚ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (structlog) Ñ SIEM-ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ñ‹Ğ¼ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚Ğ¾Ğ¼:

```json
{
  "timestamp": "2024-01-15T10:30:00Z",
  "event_type": "sql_injection_blocked",
  "severity": "critical",
  "confidence": 0.95,
  "risk_score": 0.98,
  "detection_method": "signature",
  "matched_patterns": ["or_injection"],
  "action": "blocked",
  "client_ip": "192.168.1.100",
  "path": "/api/users",
  "processing_time_ms": 5.2
}
```

---

## ğŸ¤ Ğ’ĞºĞ»Ğ°Ğ´ Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ‚

ĞœÑ‹ Ğ¿Ñ€Ğ¸Ğ²ĞµÑ‚ÑÑ‚Ğ²ÑƒĞµĞ¼ Ğ²ĞºĞ»Ğ°Ğ´ Ğ² Ğ¿Ñ€Ğ¾ĞµĞºÑ‚! ĞŸĞ¾Ğ¶Ğ°Ğ»ÑƒĞ¹ÑÑ‚Ğ°:

1. Ğ¤Ğ¾Ñ€ĞºĞ½Ğ¸Ñ‚Ğµ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¹
2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ feature branch (`git checkout -b feature/amazing-feature`)
3. Commit Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ (`git commit -m 'Add amazing feature'`)
4. Push Ğ² branch (`git push origin feature/amazing-feature`)
5. ĞÑ‚ĞºÑ€Ğ¾Ğ¹Ñ‚Ğµ Pull Request

---

## ğŸ“„ Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

Ğ­Ñ‚Ğ¾Ñ‚ Ğ¿Ñ€Ğ¾ĞµĞºÑ‚ Ğ½Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑÑ Ğ¿Ğ¾Ğ´ Ğ»Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸ĞµĞ¹ MIT - ÑĞ¼. Ñ„Ğ°Ğ¹Ğ» [LICENSE](LICENSE) Ğ´Ğ»Ñ Ğ´ĞµÑ‚Ğ°Ğ»ĞµĞ¹.

---

## ğŸ™ Ğ‘Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ğ½Ğ¾ÑÑ‚Ğ¸

- OWASP Ğ·Ğ° Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ Ğ¿Ğ¾ SQL Injection
- Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµÑÑ‚Ğ²Ğ¾ FastAPI
- Scikit-learn team

---

## ğŸ“ ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ñ‹

Ğ•ÑĞ»Ğ¸ Ñƒ Ğ²Ğ°Ñ ĞµÑÑ‚ÑŒ Ğ²Ğ¾Ğ¿Ñ€Ğ¾ÑÑ‹ Ğ¸Ğ»Ğ¸ Ğ¿Ñ€ĞµĞ´Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ñ, ÑĞ¾Ğ·Ğ´Ğ°Ğ¹Ñ‚Ğµ issue Ğ² Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸.

---

## ğŸ—ºï¸ Roadmap

- [ ] ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° NoSQL injection
- [ ] Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ Prometheus Ğ´Ğ»Ñ Ğ¼ĞµÑ‚Ñ€Ğ¸Ğº
- [ ] Dashboard Ğ´Ğ»Ñ Ğ¼Ğ¾Ğ½Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³Ğ°
- [ ] ĞŸĞ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ° GraphQL injection
- [ ] Docker ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
- [ ] Kubernetes Helm chart

---

**Made with â¤ï¸ for cybersecurity**
